# プレフィックスキー変更
unbind C-b
set -g prefix C-q
bind C-q send-prefix

# 設定ファイルの再読み込み
bind R source-file ~/.tmux.conf \; display "設定を再読み込みしました"

# ウィンドウとペインのインデックスを1から開始
set -g base-index 1
setw -g pane-base-index 1

# 256色表示を有効化
set -g default-terminal "screen-256color"

# OSC52によるクリップボード統合を有効化
set -g set-clipboard on
# ターミナルがMs(OSC52)を広告しなくても強制的に有効化
set -as terminal-overrides ',*:Ms=\E]52;c;%p2%s\007'

# ペインの背景色を設定
set -g window-style 'fg=colour251,bg=colour238'
set -g window-active-style 'fg=colour255,bg=colour232'

# ステータスバーの表示を調整して現在のウィンドウを強調
set -g status-style "fg=colour250,bg=#{?client_prefix,colour236,colour234}"
set -g status-left-length 20
set -g status-left "#{?client_prefix,#[bg=colour187]#[fg=colour236]#[bold] PREFIX #[default],}#[fg=colour39]#[bg=colour234]#[bold]#S #[default]"
set -g status-right-length 100
set -g status-right '#[fg=colour244]#{pane_title}#[default]'

setw -g window-status-separator ' '
setw -g window-status-style 'fg=colour244,bg=colour234'
setw -g window-status-format ' #[fg=colour244]#I:#W#[default] '
setw -g window-status-current-format '#[fg=colour234,bg=colour39,bold] #I:#W #[default]'

# Vimスタイルのペイン分割
bind | split-window -h
bind - split-window -v
unbind '"'
unbind %

# Vimスタイルのウィンドウ移動
bind H select-window -t :-
bind L select-window -t :+

# Vimスタイルのペイン移動
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# Vimスタイルのコピーモード
unbind [
bind y copy-mode
setw -g mode-keys vi
bind -T copy-mode-vi v send -X begin-selection
bind -T copy-mode-vi V send -X select-line
bind -T copy-mode-vi C-v send -X rectangle-toggle
# pbcopyが利用可能ならmacOSクリップボードに直接コピー、無ければOSC52に任せる
if-shell "command -v pbcopy" \
  "bind -T copy-mode-vi y send -X copy-pipe-and-cancel 'pbcopy'" \
  "bind -T copy-mode-vi y send -X copy-selection-and-cancel"
if-shell "command -v pbcopy" \
  "bind -T copy-mode-vi Enter send -X copy-pipe-and-cancel 'pbcopy'" \
  "bind -T copy-mode-vi Enter send -X copy-selection-and-cancel"
bind -T copy-mode-vi Escape send -X clear-selection
bind -T copy-mode-vi / command-prompt -p "search down"  "send -X search-forward '%%'"
bind -T copy-mode-vi ? command-prompt -p "search up"    "send -X search-backward '%%'"
bind -T copy-mode-vi n send -X search-again
bind -T copy-mode-vi N send -X search-reverse
bind -T copy-mode-vi C-a send -X start-of-line
bind -T copy-mode-vi C-e send -X end-of-line
